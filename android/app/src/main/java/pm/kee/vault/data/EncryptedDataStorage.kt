package pm.kee.vault.data

import android.content.SharedPreferences
import android.util.Base64
import pm.kee.vault.util.Util.loge
import java.lang.Exception


class EncryptedDataStorage(private val prefs: SharedPreferences) {

    private val PREF_KEY_ID = "KEY_ID"
    private val PREF_ENCRYPTED_STATE = "ENCRYPTED_STATE"
    private var plainBytes: ByteArray? = null

    private lateinit var keystore: Keystore

    private fun useMostRecentKey() {
        val id = prefs.getString(PREF_KEY_ID, null)
        id ?: return
        keystore = Keystore("pm.kee.vault.$id")
    }
    private fun setKey(id: String) {
        keystore = Keystore("pm.kee.vault.$id")

    }

    fun getJSON() : String? {
//        val temp = """
//            {"id":"Rxkkb9boJkL099RPyzSad4DPgiEnfAXk3pNPwBzbAkA=","config":{"expiry":12,"requireFullKey":false},"vault":{"dbs":[{"name":"My Kee Vault","fileName":"9a8cc281-d249-45b6-781f-f8c5ab07d424","active":true,"root":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault","childEntries":[{"uRLs":["https://www.fred.fred"],"title":"fred","uniqueID":"4dDFgKng2ioCFyv7iPPKeg==","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJpSURBVDhPjZFtSFNRHMbvXnSTreEstSjn7lbX2QZrbncORVZL/RCN6EuUKX2ICopsUETFekErKste8EMvEERRQZpEiCIUmNBgSipK1CxzZblavm+zzbanI14Ygjl/8HDvPf/nB/ecQyVCJpOlVZZa6lwnlo+fLNW4Z7+5UWJKTKbyRxX0l58vkoBfFAIdfDhsOW4yks41FqGEZfd0XE6NzPTwgAEKI20itF4QxfqvCXBk47p2Ukmeay5ApkSSUX80249eCugi8QnReZuJ2ZTarpZjyX+mXkpwuFD76r/bqS4zt065BEAPkT0kQQoTH7Lw/JAqONDARIG98FWloZg11nHKfM7uyHkfdvOBQSKPkfwl78gCIsXkeZGsH0TDVnGswGS6yinz2V5UeN7zVISonxzcEIVYTEHEbSS3SO7B61wNK53dLZVKV3BKnDy9trT5zJqxwGc+xl08hAaVRNpJUguEriP8MA+VKnFQp9Nt4ZQ4Oo3GWu/MGot842HyHR8zQzQRN5MrtAND+zB8RQGHUjSdz7LnOCWORrPW8thJj4S/8jDVK0D0ewbwQ4HJxpV4u1+M17uFsCvkwwaDoYJT4jAMwz44rfKHvTwEu8me+1Iw0SbHHXtKtCw3dcSi1z8pMBpraJpmOSXOrHz/FOML9AsQ8pDTHl2GvrsS7NKmTpqN7A21Wm3kqgtz6YChN+ARYPojhUinEP4WGRyb5GHyq+VcZXGab64KwEfuelSMpmopihjlJwvL1pCRcK6RgMaqjGlvUxI8z6SwmzN/p6enq7nR0rAV5tfaTLnt1g3r35jN5uPc8hKhqH9mBy2MUTy6KwAAAABJRU5ErkJggg==","hTTPRealm":"","formFieldList":[{"name":"","displayName":"KeePass username","value":"fred1","type":"FFTusername","id":"","page":1},{"name":"","displayName":"KeePass password","value":"fr3d1","type":"FFTpassword","id":"","page":1}],"alwaysAutoFill":false,"neverAutoFill":false,"alwaysAutoSubmit":false,"neverAutoSubmit":false,"priority":0,"parent":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault"},"db":{"name":"My Kee Vault","fileName":"9a8cc281-d249-45b6-781f-f8c5ab07d424","active":true,"root":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault"},"iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg=="},"matchAccuracy":0}],"childLightEntries":[],"childGroups":[{"title":"Import at 06/06/2019, 23:25:44","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"o1aTN2EVz0FrT6L3lL1Aog==","path":"My Kee Vault/Import at 06/06/2019, 23:25:44","childEntries":[{"uRLs":["https://www.fred.fred"],"title":"fred","uniqueID":"yCtFPux5CcR63iOzC6GhfQ==","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJpSURBVDhPjZFtSFNRHMbvXnSTreEstSjn7lbX2QZrbncORVZL/RCN6EuUKX2ICopsUETFekErKste8EMvEERRQZpEiCIUmNBgSipK1CxzZblavm+zzbanI14Ygjl/8HDvPf/nB/ecQyVCJpOlVZZa6lwnlo+fLNW4Z7+5UWJKTKbyRxX0l58vkoBfFAIdfDhsOW4yks41FqGEZfd0XE6NzPTwgAEKI20itF4QxfqvCXBk47p2Ukmeay5ApkSSUX80249eCugi8QnReZuJ2ZTarpZjyX+mXkpwuFD76r/bqS4zt065BEAPkT0kQQoTH7Lw/JAqONDARIG98FWloZg11nHKfM7uyHkfdvOBQSKPkfwl78gCIsXkeZGsH0TDVnGswGS6yinz2V5UeN7zVISonxzcEIVYTEHEbSS3SO7B61wNK53dLZVKV3BKnDy9trT5zJqxwGc+xl08hAaVRNpJUguEriP8MA+VKnFQp9Nt4ZQ4Oo3GWu/MGot842HyHR8zQzQRN5MrtAND+zB8RQGHUjSdz7LnOCWORrPW8thJj4S/8jDVK0D0ewbwQ4HJxpV4u1+M17uFsCvkwwaDoYJT4jAMwz44rfKHvTwEu8me+1Iw0SbHHXtKtCw3dcSi1z8pMBpraJpmOSXOrHz/FOML9AsQ8pDTHl2GvrsS7NKmTpqN7A21Wm3kqgtz6YChN+ARYPojhUinEP4WGRyb5GHyq+VcZXGab64KwEfuelSMpmopihjlJwvL1pCRcK6RgMaqjGlvUxI8z6SwmzN/p6enq7nR0rAV5tfaTLnt1g3r35jN5uPc8hKhqH9mBy2MUTy6KwAAAABJRU5ErkJggg==","hTTPRealm":"","formFieldList":[{"name":"","displayName":"KeePass username","value":"fred1","type":"FFTusername","id":"","page":1},{"name":"","displayName":"KeePass password","value":"fr3d1","type":"FFTpassword","id":"","page":1}],"alwaysAutoFill":false,"neverAutoFill":false,"alwaysAutoSubmit":false,"neverAutoSubmit":false,"priority":0,"parent":{"title":"Import at 06/06/2019, 23:25:44","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"o1aTN2EVz0FrT6L3lL1Aog==","path":"My Kee Vault/Import at 06/06/2019, 23:25:44"},"db":{"name":"My Kee Vault","fileName":"9a8cc281-d249-45b6-781f-f8c5ab07d424","active":true,"root":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault"},"iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg=="},"matchAccuracy":0}],"childLightEntries":[],"childGroups":[]},{"title":"Import at 06/06/2019, 23:47:05","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"xTAOi3HFL47c9FmB9RqCng==","path":"My Kee Vault/Import at 06/06/2019, 23:47:05","childEntries":[{"uRLs":["https://www.fred.fred"],"title":"fred","uniqueID":"dpeCRLagLKC6b0tDVaALgA==","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJpSURBVDhPjZFtSFNRHMbvXnSTreEstSjn7lbX2QZrbncORVZL/RCN6EuUKX2ICopsUETFekErKste8EMvEERRQZpEiCIUmNBgSipK1CxzZblavm+zzbanI14Ygjl/8HDvPf/nB/ecQyVCJpOlVZZa6lwnlo+fLNW4Z7+5UWJKTKbyRxX0l58vkoBfFAIdfDhsOW4yks41FqGEZfd0XE6NzPTwgAEKI20itF4QxfqvCXBk47p2Ukmeay5ApkSSUX80249eCugi8QnReZuJ2ZTarpZjyX+mXkpwuFD76r/bqS4zt065BEAPkT0kQQoTH7Lw/JAqONDARIG98FWloZg11nHKfM7uyHkfdvOBQSKPkfwl78gCIsXkeZGsH0TDVnGswGS6yinz2V5UeN7zVISonxzcEIVYTEHEbSS3SO7B61wNK53dLZVKV3BKnDy9trT5zJqxwGc+xl08hAaVRNpJUguEriP8MA+VKnFQp9Nt4ZQ4Oo3GWu/MGot842HyHR8zQzQRN5MrtAND+zB8RQGHUjSdz7LnOCWORrPW8thJj4S/8jDVK0D0ewbwQ4HJxpV4u1+M17uFsCvkwwaDoYJT4jAMwz44rfKHvTwEu8me+1Iw0SbHHXtKtCw3dcSi1z8pMBpraJpmOSXOrHz/FOML9AsQ8pDTHl2GvrsS7NKmTpqN7A21Wm3kqgtz6YChN+ARYPojhUinEP4WGRyb5GHyq+VcZXGab64KwEfuelSMpmopihjlJwvL1pCRcK6RgMaqjGlvUxI8z6SwmzN/p6enq7nR0rAV5tfaTLnt1g3r35jN5uPc8hKhqH9mBy2MUTy6KwAAAABJRU5ErkJggg==","hTTPRealm":"","formFieldList":[{"name":"","displayName":"KeePass username","value":"fred1","type":"FFTusername","id":"","page":1},{"name":"","displayName":"KeePass password","value":"fr3d1","type":"FFTpassword","id":"","page":1}],"alwaysAutoFill":false,"neverAutoFill":false,"alwaysAutoSubmit":false,"neverAutoSubmit":false,"priority":0,"parent":{"title":"Import at 06/06/2019, 23:47:05","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"xTAOi3HFL47c9FmB9RqCng==","path":"My Kee Vault/Import at 06/06/2019, 23:47:05"},"db":{"name":"My Kee Vault","fileName":"9a8cc281-d249-45b6-781f-f8c5ab07d424","active":true,"root":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault"},"iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg=="},"matchAccuracy":0},{"uRLs":["https://www.fred.fred"],"title":"fred","uniqueID":"HdK+cqtL7FZkMNxFdrarmg==","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJpSURBVDhPjZFtSFNRHMbvXnSTreEstSjn7lbX2QZrbncORVZL/RCN6EuUKX2ICopsUETFekErKste8EMvEERRQZpEiCIUmNBgSipK1CxzZblavm+zzbanI14Ygjl/8HDvPf/nB/ecQyVCJpOlVZZa6lwnlo+fLNW4Z7+5UWJKTKbyRxX0l58vkoBfFAIdfDhsOW4yks41FqGEZfd0XE6NzPTwgAEKI20itF4QxfqvCXBk47p2Ukmeay5ApkSSUX80249eCugi8QnReZuJ2ZTarpZjyX+mXkpwuFD76r/bqS4zt065BEAPkT0kQQoTH7Lw/JAqONDARIG98FWloZg11nHKfM7uyHkfdvOBQSKPkfwl78gCIsXkeZGsH0TDVnGswGS6yinz2V5UeN7zVISonxzcEIVYTEHEbSS3SO7B61wNK53dLZVKV3BKnDy9trT5zJqxwGc+xl08hAaVRNpJUguEriP8MA+VKnFQp9Nt4ZQ4Oo3GWu/MGot842HyHR8zQzQRN5MrtAND+zB8RQGHUjSdz7LnOCWORrPW8thJj4S/8jDVK0D0ewbwQ4HJxpV4u1+M17uFsCvkwwaDoYJT4jAMwz44rfKHvTwEu8me+1Iw0SbHHXtKtCw3dcSi1z8pMBpraJpmOSXOrHz/FOML9AsQ8pDTHl2GvrsS7NKmTpqN7A21Wm3kqgtz6YChN+ARYPojhUinEP4WGRyb5GHyq+VcZXGab64KwEfuelSMpmopihjlJwvL1pCRcK6RgMaqjGlvUxI8z6SwmzN/p6enq7nR0rAV5tfaTLnt1g3r35jN5uPc8hKhqH9mBy2MUTy6KwAAAABJRU5ErkJggg==","hTTPRealm":"","formFieldList":[{"name":"","displayName":"KeePass username","value":"fred1","type":"FFTusername","id":"","page":1},{"name":"","displayName":"KeePass password","value":"fr3d1","type":"FFTpassword","id":"","page":1}],"alwaysAutoFill":false,"neverAutoFill":false,"alwaysAutoSubmit":false,"neverAutoSubmit":false,"priority":0,"parent":{"title":"Import at 06/06/2019, 23:47:05","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"xTAOi3HFL47c9FmB9RqCng==","path":"My Kee Vault/Import at 06/06/2019, 23:47:05"},"db":{"name":"My Kee Vault","fileName":"9a8cc281-d249-45b6-781f-f8c5ab07d424","active":true,"root":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault"},"iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg=="},"matchAccuracy":0}],"childLightEntries":[],"childGroups":[]},{"title":"Import at 6/7/2019, 12:31:03 PM","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"PqwJanCDK2WIaF/Nz8DzFQ==","path":"My Kee Vault/Import at 6/7/2019, 12:31:03 PM","childEntries":[{"uRLs":["https://www.fred.fred"],"title":"fred","uniqueID":"5Yf+N1Zjv43b7CxFQ7OyzA==","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJpSURBVDhPjZFtSFNRHMbvXnSTreEstSjn7lbX2QZrbncORVZL/RCN6EuUKX2ICopsUETFekErKste8EMvEERRQZpEiCIUmNBgSipK1CxzZblavm+zzbanI14Ygjl/8HDvPf/nB/ecQyVCJpOlVZZa6lwnlo+fLNW4Z7+5UWJKTKbyRxX0l58vkoBfFAIdfDhsOW4yks41FqGEZfd0XE6NzPTwgAEKI20itF4QxfqvCXBk47p2Ukmeay5ApkSSUX80249eCugi8QnReZuJ2ZTarpZjyX+mXkpwuFD76r/bqS4zt065BEAPkT0kQQoTH7Lw/JAqONDARIG98FWloZg11nHKfM7uyHkfdvOBQSKPkfwl78gCIsXkeZGsH0TDVnGswGS6yinz2V5UeN7zVISonxzcEIVYTEHEbSS3SO7B61wNK53dLZVKV3BKnDy9trT5zJqxwGc+xl08hAaVRNpJUguEriP8MA+VKnFQp9Nt4ZQ4Oo3GWu/MGot842HyHR8zQzQRN5MrtAND+zB8RQGHUjSdz7LnOCWORrPW8thJj4S/8jDVK0D0ewbwQ4HJxpV4u1+M17uFsCvkwwaDoYJT4jAMwz44rfKHvTwEu8me+1Iw0SbHHXtKtCw3dcSi1z8pMBpraJpmOSXOrHz/FOML9AsQ8pDTHl2GvrsS7NKmTpqN7A21Wm3kqgtz6YChN+ARYPojhUinEP4WGRyb5GHyq+VcZXGab64KwEfuelSMpmopihjlJwvL1pCRcK6RgMaqjGlvUxI8z6SwmzN/p6enq7nR0rAV5tfaTLnt1g3r35jN5uPc8hKhqH9mBy2MUTy6KwAAAABJRU5ErkJggg==","hTTPRealm":"","formFieldList":[{"name":"","displayName":"KeePass username","value":"fred1","type":"FFTusername","id":"","page":1},{"name":"","displayName":"KeePass password","value":"fr3d1","type":"FFTpassword","id":"","page":1}],"alwaysAutoFill":false,"neverAutoFill":false,"alwaysAutoSubmit":false,"neverAutoSubmit":false,"priority":0,"parent":{"title":"Import at 6/7/2019, 12:31:03 PM","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"PqwJanCDK2WIaF/Nz8DzFQ==","path":"My Kee Vault/Import at 6/7/2019, 12:31:03 PM"},"db":{"name":"My Kee Vault","fileName":"9a8cc281-d249-45b6-781f-f8c5ab07d424","active":true,"root":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault"},"iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg=="},"matchAccuracy":0},{"uRLs":["https://www.fred.fred"],"title":"fred","uniqueID":"8qViigvgoeOZhf/yxpCdlg==","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJpSURBVDhPjZFtSFNRHMbvXnSTreEstSjn7lbX2QZrbncORVZL/RCN6EuUKX2ICopsUETFekErKste8EMvEERRQZpEiCIUmNBgSipK1CxzZblavm+zzbanI14Ygjl/8HDvPf/nB/ecQyVCJpOlVZZa6lwnlo+fLNW4Z7+5UWJKTKbyRxX0l58vkoBfFAIdfDhsOW4yks41FqGEZfd0XE6NzPTwgAEKI20itF4QxfqvCXBk47p2Ukmeay5ApkSSUX80249eCugi8QnReZuJ2ZTarpZjyX+mXkpwuFD76r/bqS4zt065BEAPkT0kQQoTH7Lw/JAqONDARIG98FWloZg11nHKfM7uyHkfdvOBQSKPkfwl78gCIsXkeZGsH0TDVnGswGS6yinz2V5UeN7zVISonxzcEIVYTEHEbSS3SO7B61wNK53dLZVKV3BKnDy9trT5zJqxwGc+xl08hAaVRNpJUguEriP8MA+VKnFQp9Nt4ZQ4Oo3GWu/MGot842HyHR8zQzQRN5MrtAND+zB8RQGHUjSdz7LnOCWORrPW8thJj4S/8jDVK0D0ewbwQ4HJxpV4u1+M17uFsCvkwwaDoYJT4jAMwz44rfKHvTwEu8me+1Iw0SbHHXtKtCw3dcSi1z8pMBpraJpmOSXOrHz/FOML9AsQ8pDTHl2GvrsS7NKmTpqN7A21Wm3kqgtz6YChN+ARYPojhUinEP4WGRyb5GHyq+VcZXGab64KwEfuelSMpmopihjlJwvL1pCRcK6RgMaqjGlvUxI8z6SwmzN/p6enq7nR0rAV5tfaTLnt1g3r35jN5uPc8hKhqH9mBy2MUTy6KwAAAABJRU5ErkJggg==","hTTPRealm":"","formFieldList":[{"name":"","displayName":"KeePass username","value":"fred1","type":"FFTusername","id":"","page":1},{"name":"","displayName":"KeePass password","value":"fr3d1","type":"FFTpassword","id":"","page":1}],"alwaysAutoFill":false,"neverAutoFill":false,"alwaysAutoSubmit":false,"neverAutoSubmit":false,"priority":0,"parent":{"title":"Import at 6/7/2019, 12:31:03 PM","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHBSURBVDhPpZPdS9NRGMd/vQghRKzdj0Zsiy4mcy/diXRhiARDBw7MBEG6MChFBEG9UKnhoHaziomviDnLfEtDLRGMfAkCESWiC29+f8fH55yjlXOC0gMfHs7z+z7f55zD+VkSF62yeXJxuVy35VuBcEmJTg8R5wtV93q9d0VRKFw+RJldEP4JEa7vc4Ijk1xO7kyK87toPqq8B3OSFflC6X0+X6l0KhNjMLgJrbP5J57GXxNZJJZN83lC6T0ezx1t0PTBFFZ+o1n8JUf5CVNyjOw2jPyAzBa83oDyepsXa0YfDofbtUHNsCm834FJQTWNStPAd0ivQ+or9K5CzxcoqbXpXDL6YDD4UhuUpU0hIxPeCK++mabkYVPHotzRAjTJPUXiNo+n/xiktEFxwhSer8AzofszekrbJ2ieQzc8moT6CSiK2dRlcwxudJqCmvB0Bp4IjVPQ8A7qxuHBW6gehaoRuBW1dT5mcL3FFB6KuFbENWMQl4aYCKNDUNEP9/oMN+/bOit9KBRKWPplyeK8+P3+bCAQiKunVOB2uyPi1iZbSp4F0XaJQaXD4bimDFSoH+SK0+m8ehZEe/SD/W9Y1gG9HgDrgogVBgAAAABJRU5ErkJggg==","uniqueID":"PqwJanCDK2WIaF/Nz8DzFQ==","path":"My Kee Vault/Import at 6/7/2019, 12:31:03 PM"},"db":{"name":"My Kee Vault","fileName":"9a8cc281-d249-45b6-781f-f8c5ab07d424","active":true,"root":{"title":"My Kee Vault","iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg==","uniqueID":"fHlpBgKCQMfsd3Db24c5Aw==","path":"My Kee Vault"},"iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg=="},"matchAccuracy":0}],"childLightEntries":[],"childGroups":[]}]},"iconImageData":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAG1SURBVDhPrZNLKERhFMfHY0pKcWehRqZmc5tMUzPdyUJTirCgNAuPWUgSSTbSEAuzUUhNHgvJs1ATeSyQqCGPBRlJWbK7Vta2f+d839wZLiYLp37d7nf+/3PO993vWiiyLbWHMONwOMooZ2VB5iDxT8HrqqpWkSKfyCVyiCzCFCRMvOIbRpHP/DwVJeIvEJw+p5+MOVj7aarkNLQYewTW7iGeTM3C9+5mtEBDP7mpEL1MXyFFx5Y0v70n2/4SrHG73XWiwPAxUpRNyOTOk5xm/QFYSQALt0BDl47ZawhY4/f7w6JA5zYEgTmZ4O0s3QHzN1I8dQGMnwHV7TpGT6TG4/Hs+Xy+VlGgcRWCokGZjF4Ck+fAWBzCwJOF6WuXt+ro2091n7HZbHZRoGIWKI3IhGEYOgIGDiAMvXtA9w6gNeum7nw/aKEwLM0Mi3t2pYEPtC0GhDaBpnU6n6AswN0VRSkRX9EwFo/ITixu2ZCG4JrcWv0yULeY3rvX6w3Z7XZV+MXtShb5C9Q9qsjuqWttdTqd5ZQY1jRtKhOkibhcrkry8L/xJbhaHp1qQSZIY/xY/xUWywdpBtlFmORVPwAAAABJRU5ErkJggg=="}],"config":{"settings":{"autoFillForms":true,"autoFillFormsWithMultipleMatches":false,"autoSubmitForms":false,"autoSubmitMatchedForms":true,"listAllOpenDBs":true,"logLevel":4,"mruGroup":{"6ba66e45-22ea-b9a3-baca-d52d85b4480b":"bHHdB+e2C02EFXzu1FdXKA==","354dc1e6-aee8-f904-8490-476061bca0f5":"KVlzSK9fKEmyyGEhWr13AQ==","/home/luckyrat/Dropbox/TheLuckyratDatabase.kdbx":"F2D2605BE923204C851553180C58755A","e48792f0-e933-b164-52a9-bae1fb864730":"tpzRSkNWVv1KY1ZAmykPPQ==","1d680e22-b9d2-4d05-1f4a-2f0328f5ec5b":"pCqbOXpLFc3MruxNaewOrg==","6c10c076-2c91-d0f6-98af-9df127907542":"vQ4bJfqt0jX5EivgvPBCNQ=="},"notifyWhenEntryUpdated":true,"overWriteFieldsAutomatically":true,"rememberMRUDB":true,"rememberMRUGroup":true,"saveFavicons":true,"searchAllOpenDBs":true,"siteConfig":{"pageRegex":{"^.*${'$'}":{"config":{"preventSaveNotification":false,"blackList":{"form":{"names":["search"],"ids":["search"]},"fields":{"names":["search","q","query"],"ids":["search","q"]}},"whiteList":{"form":{"names":["login"],"ids":["login"]},"fields":{"names":["username","j_username","user_name","user","user-name","login","vb_login_username","name","user name","user id","user-id","userid","email","e-mail","id","form_loginname","wpname","mail","loginid","login id","login_name","openid_identifier","authentication_email","openid","auth_email","auth_id","authentication_identifier","authentication_id","customer_number","customernumber","onlineid"],"ids":["username","j_username","user_name","user","user-name","login","vb_login_username","name","user-id","userid","email","e-mail","id","form_loginname","wpname","mail","loginid","login_name","openid_identifier","authentication_email","openid","auth_email","auth_id","authentication_identifier","authentication_id","customer_number","customernumber","onlineid"]}}},"matchWeight":0,"source":"Default"}},"hostExact":{"www.google.co.uk":{"config":{"preventSaveNotification":true},"source":"User","matchWeight":100},"ssdafsdaf":{"config":{},"source":"User","matchWeight":100},"sadfsdfvbsdgfbsdfgb":{"config":{},"source":"User","matchWeight":10},"sgzfddfzgvbdf":{"config":{},"source":"User","matchWeight":100},"sdfbgdfjhngfhdjdfghnfgh":{"config":{"preventSaveNotification":true},"source":"User","matchWeight":100},"fdsrtjftghnvcbn":{"config":{},"source":"User","matchWeight":100},"fdsrtjftghnvcssadfasdfbn":{"config":{},"source":"User","matchWeight":100},"www.test.com":{"config":{"preventSaveNotification":true},"source":"User","matchWeight":100}},"pageExact":{},"pagePrefix":{"www.google.com":{"config":{"preventSaveNotification":false},"source":"User","matchWeight":100}},"hostRegex":{},"hostPrefix":{},"domainExact":{"fsdhfgdbfdgb":{"config":{"preventSaveNotification":false},"source":"User","matchWeight":100}}},"autoSubmitNetworkAuthWithSingleMatch":false,"notificationCountGeneric":3,"notificationCountSavePassword":10,"currentSearchTermTimeout":30,"animateWhenOfferingSave":true,"manualSubmitOverrideProhibited":false},"version":6}}}
//        """.trimIndent()
//        return temp
        useMostRecentKey()
        decryptStorage()
        plainBytes?.let { return String(it, Charsets.UTF_8) }
        return null
    }
    fun setJSON(id: String, json: String) {
        plainBytes = json.toByteArray(Charsets.UTF_8)
        setKey(id)
        encryptStorage(id)
    }
    private fun decryptStorage() {
        try {
            val str = prefs.getString(PREF_ENCRYPTED_STATE, null)
            loge("read state: $str")
            val ba = Base64.decode(str, Base64.DEFAULT)

//            val ba = str?.toByteArray(Charsets.ISO_8859_1)
            plainBytes = null
            ba?.let {
//                val hack = String(ba, Charsets.ISO_8859_1)
//                loge("re-read state: $hack")
                var output = keystore.decryptBytes(ba)
                plainBytes = output
            }
        } catch (e: Exception) {
            loge("Exception: $e")
        }
    }
    private fun encryptStorage(id: String) {
        val cipherBytes = plainBytes?.let { keystore.encryptBytes(it) }
        cipherBytes ?: return;
        val str = Base64.encodeToString(cipherBytes, Base64.DEFAULT)
//        val str = String(cipherBytes, Charsets.ISO_8859_1)
        with (prefs.edit()) {
            putString(PREF_KEY_ID, id)
            putString(PREF_ENCRYPTED_STATE, str)
            commit()
        }
        loge("write state: $str")
    }
    fun isAvailable() = (plainBytes != null)






//
//    private val CIPHER_CHUCK_SIZE = 64 * 1024
//    @Throws(GeneralSecurityException::class)
//    fun encrypt(message: ByteArray): ByteArray {
//        val cipher = Cipher.getInstance(AES_MODE)
//        cipher.init(Cipher.ENCRYPT_MODE, getSecretKey())
//        val parameterSpec = cipher.getParameters().getParameterSpec(GCMParameterSpec::class.java)
//        val outLen = cipher.getOutputSize(message.size)
//
//        val bout = ByteArrayOutputStream()
//        try {
//            var i = 0
//            while (i < message.size) {
//                val len = Math.min(CIPHER_CHUCK_SIZE, message.size - i)
//                bout.write(cipher.update(message, i, len))
//                i += CIPHER_CHUCK_SIZE
//            }
//            bout.write(cipher.doFinal())
//        } catch (e: IOException) {
//            e.printStackTrace()
//            throw GeneralSecurityException(e)
//        }
//
//        val cryptedBytes = bout.toByteArray()
//        if (outLen != cryptedBytes.size)
//            throw GeneralSecurityException("cryptedBytes too small")
//
//        val iv = parameterSpec.getIV()
//        val encryptedSecretKey = getEncryptedSecretKey()
//        return ByteBuffer.allocate(iv.size + encryptedSecretKey.size + cryptedBytes.size)
//                .put(iv)
//                .put(encryptedSecretKey)
//                .put(cryptedBytes)
//                .array()
//    }
//
//    @Throws(GeneralSecurityException::class)
//    fun decrypt(bytes: ByteArray): ByteArray {
//        val buffer = ByteBuffer.wrap(bytes)
//        val iv = ByteArray(IV_SIZE)
//        buffer.get(iv)
//
//        //skip aes key bytes
//        val irrelevant = ByteArray(AES_KEY_SIZE * 8)
//        buffer.get(irrelevant)
//
//        val encryptedMessage = ByteArray(bytes.size - IV_SIZE - irrelevant.size)
//        buffer.get(encryptedMessage)
//
//        val cipher = Cipher.getInstance(AES_MODE)
//        val parameterSpec = GCMParameterSpec(AES_TAG_LEN, iv)
//        cipher.init(Cipher.DECRYPT_MODE, getSecretKey(), parameterSpec)
//
//        val bout = ByteArrayOutputStream()
//        try {
//            var i = 0
//            while (i < encryptedMessage.size) {
//                val len = Math.min(CIPHER_CHUCK_SIZE, encryptedMessage.size - i)
//                cipher.update(encryptedMessage, i, len)
//                i += CIPHER_CHUCK_SIZE
//            }
//            bout.write(cipher.doFinal())
//        } catch (e: IOException) {
//            e.printStackTrace()
//            throw GeneralSecurityException(e)
//        }
//
//        return bout.toByteArray()
//    }

}
